sequenceDiagram
    Start ->>+ PermissionActivity: onRequestPermissionsResult(requestCode,permissions,grantResults)
    PermissionActivity ->>+ PermissionManager: handleRequestPermissionsResult(:PermissionsSpec,permissions,grantResults)
    alt are all permissions granted
        PermissionManager ->>+ PermissionListener: permissionsGranted(:PermissionsSpec)
        PermissionListener ->>+ PermissionActivity: onPermissionsGranted(:PermissionsSpec)
        PermissionActivity -->>- PermissionListener: x
        PermissionListener -->>- PermissionManager: x
    else
        PermissionManager ->>+ ActivityCompat: shouldShowRequestPermissionRationale(deniedPermission)
        ActivityCompat -->>- PermissionManager: x
    end
    PermissionManager -->>- PermissionActivity: x
    PermissionActivity -->>- Start: x
    Settings ->>+ PermissionActivity: onResume()
    PermissionActivity ->>+ PermissionManager: handleResume()
    PermissionManager -->>- PermissionActivity: x
